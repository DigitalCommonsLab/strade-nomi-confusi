<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
<title>strade nomi confusi</title> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" />

<style type="text/css">
#map {
	position: absolute;
	width: 100%;
	height: 100%;
}
</style>
</head> 	
<body>

<div id="map"></div>

<script src="https://unpkg.com/jquery@3.3.1/dist/jquery.js"></script>
<script src="https://unpkg.com/underscore@1.8.3/underscore.js"></script>
<script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet-src.js"></script>
<script>

function randomColor() {
  var letters = '0123456789ABCDEF';
  var color = '#';
  for (var i = 0; i < 6; i++) {
    color += letters[Math.floor(Math.random() * 16)];
  }
  return color;
}

var map = new L.Map('map', {
		zoom: 15,
		center: new L.latLng([46.07,11.13]),
		layers: L.tileLayer('http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png', {
			maxZoom: 18,
			attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
		})
	});


	$.getJSON('data/highway.json', function(json) {

		//TODO normalize properties name:it short_name to only name

		var geo = L.geoJSON(json, {
				style: function(f) {
					return {
						weight: 4,
						opacity: 0.8,
						color: randomColor()
					};
				},
				onEachFeature: function (f, layer) {
					
					layer.bindTooltip(f.properties.name);

					var html = '<h2>'+f.properties.name+'</h2>';
					layer.bindPopup(html);
					layer.on('mouseover', function(e) {
						
						e.target.bringToFront();
						e.target.openTooltip();

						e.target.defStyle = f.style;
						e.target.setStyle({
							weight: 10,
							opacity: 1,
						});
					}).on('mouseout', function(e) {
						e.target.setStyle({
							weight:4,
							opacity:0.8
						})
					});
				}
			});
		//TODO fitBounds(json.bbox)
		geo.addTo(map);

	});
</script>
</body>
</html>
